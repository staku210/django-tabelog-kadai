{% extends "base.html" %}
{% block title %}åº—èˆ—è©³ç´°{% endblock %}

{% block main %}
<div class="container mt-5">

  <!-- åº—èˆ—æƒ…å ± -->
  <div class="row mb-5">

    <!-- ç”»åƒ -->
    <div class="col-md-6 mb-4">
      <div class="card shadow-sm">
        <img src="{{ restaurant.img.url }}"
             class="card-img-top"
             style="height:360px; object-fit:cover;">
      </div>
    </div>

    <!-- æƒ…å ± -->
    <div class="col-md-6">
      <div class="card shadow-sm h-100">
        <div class="card-body d-flex flex-column">

          <h3 class="fw-bold mb-3">{{ restaurant.name }}</h3>

          <p>ğŸ’° <strong>äºˆç®—ï¼š</strong>{{ restaurant.price }}</p>
          <p>ğŸ“ <strong>ä½æ‰€ï¼š</strong>{{ restaurant.address }}</p>
          <p>ğŸ· <strong>ã‚«ãƒ†ã‚´ãƒªï¼š</strong>{{ restaurant.category }}</p>
          <p>â˜ <strong>é›»è©±ç•ªå·ï¼š</strong>{{ restaurant.phone }}</p>
          <p><strong>èª¬æ˜ï¼š</strong> {{ restaurant.description }}</p>

          <div class="mt-auto">
            <a href="{% url 'reservation' restaurant_id=restaurant.pk %}"
               class="btn btn-success w-100 mb-2">
              äºˆç´„ã™ã‚‹
            </a>
          </div>

        </div>
      </div>
    </div>

  </div>

  <!-- ================= ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¸€è¦§ ================= -->

  <div class="mb-5">

    <h4 class="fw-bold mb-3">å£ã‚³ãƒŸãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼</h4>

    {% for review in reviews %}
      <div class="card shadow-sm mb-3">
        <div class="card-body">

          <div class="d-flex justify-content-between align-items-center mb-2">
            <strong>{{ review.user.username }}</strong>
            <span class="badge bg-warning text-dark">â­ {{ review.rating }}</span>
          </div>

          <p class="mb-2">{{ review.comment }}</p>
          <small class="text-muted">{{ review.created_at }}</small>

          {% if review.user.id == request.user.id %}
          <div class="mt-2 d-flex gap-2">
            <a href="{% url 'review_update' review.pk %}"
               class="btn btn-outline-primary btn-sm">
              ç·¨é›†
            </a>
            <a href="{% url 'review_delete' review.pk %}"
               class="btn btn-outline-danger btn-sm">
              å‰Šé™¤
            </a>
          </div>
          {% endif %}

        </div>
      </div>
    {% empty %}
      <p class="text-muted">ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    {% endfor %}
  </div>

  <!-- ================= ãƒ¬ãƒ“ãƒ¥ãƒ¼æŠ•ç¨¿ ================= -->

  <div class="card shadow-sm mb-5">

    <div class="card-body">
      <h5 class="fw-bold mb-3">ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’æŠ•ç¨¿</h5>

      <form method="post" action="{% url 'review' restaurant.id %}">
        {% csrf_token %}

        <div class="mb-3">
         <label for="id_rating" class="form-label">è©•ä¾¡</label>
         {{ form.rating }}
       </div>

        <div class="mb-3">
         <label for="id_comment" class="form-label">ãƒ¬ãƒ“ãƒ¥ãƒ¼å†…å®¹</label>
         {{ form.comment }}
       </div>

        {% if form.errors %}
          <div class="alert alert-danger">
            å…¥åŠ›å†…å®¹ã«ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™ã€‚
          </div>
        {% endif %}

        <button type="submit" class="btn btn-primary w-100">
          æŠ•ç¨¿ã™ã‚‹
        </button>
      </form>
    </div>

  </div>

  <!-- æˆ»ã‚‹ -->
  <div class="text-center mb-5">
    <a href="{% url 'list' %}" class="btn btn-outline-dark">
      â† åº—èˆ—ä¸€è¦§ã¸æˆ»ã‚‹
    </a>
  </div>

</div>
{% endblock %}




